<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Koszyk</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          rel="stylesheet">
    <link th:href="@{/css/main.css}" rel="stylesheet">
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-4">
    <a class="navbar-brand" href="/">Cinema3D</a>

    <div class="collapse navbar-collapse">
        <ul class="navbar-nav me-auto">
            <li class="nav-item"><a class="nav-link" href="/movies">Filmy</a></li>
            <li class="nav-item"><a class="nav-link" href="/screenings">Seanse</a></li>
            <li class="nav-item"><a class="nav-link active" href="/cart">Koszyk</a></li>
        </ul>
    </div>
</nav>

<section class="container mt-5 mb-5">

    <h1 class="mb-4">Twój koszyk</h1>

    <!-- BRAK MIEJSC -->
    <div th:if="${#lists.isEmpty(items)}" class="alert alert-info">
        Brak zarezerwowanych miejsc.
        <a href="/screenings" class="alert-link">Wróć do repertuaru</a>
    </div>

    <!-- FORMULARZ FINALIZACJI -->
    <form th:if="${!#lists.isEmpty(items)}"
          action="/booking/confirm"
          method="post">

        <!-- bierzemy pierwszy ScreeningSeat tylko do nagłówka -->
        <div class="card mb-4" th:with="firstItem=${items[0]}">
            <div class="card-body p-0">

                <div class="cart-layout">

                    <!-- OKŁADKA FILMU -->
                    <div class="cart-cover"
                         th:if="${firstItem.screening.movie.coverPath != null}"
                         th:style="|background-image: url('/uploads/movies/${firstItem.screening.movie.coverPath}')|">
                    </div>

                    <!-- TREŚĆ -->
                    <div class="cart-content p-4">

                        <h3 th:text="${firstItem.screening.movie.title}"></h3>

                        <p class="text-muted mb-4">
                            Seans:
                            <span th:text="${#temporals.format(firstItem.screening.startTime, 'yyyy-MM-dd HH:mm')}"></span>
                        </p>

                        <!-- LISTA MIEJSC -->
                        <div th:each="item : ${items}"
                             class="d-flex align-items-center justify-content-between border-bottom py-3">

                            <div>
                                <strong>
                                    Rząd
                                    <span th:text="${T(java.lang.Character).toString(64 + item.seat.row)}"></span>,
                                    miejsce
                                    <span th:text="${item.seat.number}"></span>
                                </strong>
                            </div>

                            <!-- TYP BILETU -->
                            <select class="form-select w-auto"
                                    name="ticketTypes"
                                    required>
                                <option value="" disabled selected>
                                    Wybierz typ biletu
                                </option>
                                <option th:each="type : ${ticketTypes}"
                                        th:value="${type}"
                                        th:text="${type}">
                                </option>
                            </select>

                        </div>

                    </div>
                </div>
            </div>
        </div>

        <!-- CTA -->
        <div class="text-end">
            <button type="submit" class="btn btn-success btn-lg">
                Potwierdź rezerwację
            </button>
        </div>

    </form>

</section>

</body>
</html>
